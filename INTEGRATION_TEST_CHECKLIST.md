# Frontend-Backend Integration Test Checklist

## âœ… **Integration Complete**

### **Files Modified/Created:**

#### **New Infrastructure Files:**
- âœ… `src/lib/apiClient.ts` - API client for backend communication
- âœ… `src/hooks/useApiAuth.ts` - Authentication helper hook  
- âœ… `src/utils/apiErrors.ts` - Error handling utilities
- âœ… `.env` - Added VITE_BACKEND_URL
- âœ… `.env.development` - Development environment config
- âœ… `.env.production` - Production environment config

#### **Modified Components:**
- âœ… `src/hooks/useUserProfile.ts` - Updated to use backend API for writes
- âœ… `src/components/markets/CreateMarketForm.tsx` - Updated to use backend API
- âœ… `src/pages/Onboarding.tsx` - Updated to pass image files to backend

### **Key Changes Made:**

1. **âœ… Authentication Flow**
   - All write operations now require wallet signature authentication
   - Authentication messages generated by backend
   - Signatures validated server-side

2. **âœ… Image Upload Migration**
   - Removed direct Supabase storage operations from frontend
   - Image files now passed to backend for processing and upload
   - Backend handles image optimization and storage

3. **âœ… Error Handling**
   - Centralized error formatting for consistent user messages
   - Network error detection and user-friendly fallbacks
   - Wallet signature rejection handling

4. **âœ… Environment Configuration**
   - Backend URL configurable per environment
   - Fallback to localhost for development

## ðŸ§ª **Testing Requirements**

### **Prerequisites:**
- [ ] Backend server running on localhost:3001
- [ ] Backend health endpoint responding: `curl http://localhost:3001/health`
- [ ] Wallet connected with test funds
- [ ] Frontend environment variables set correctly

### **User Profile Testing:**
- [ ] **Profile Creation with Image**
  - Navigate to onboarding
  - Fill out username and display name
  - Upload a profile image
  - Submit form
  - Verify profile created successfully
  - Check image appears correctly

- [ ] **Profile Creation without Image**
  - Complete profile creation without uploading image
  - Verify profile created successfully

- [ ] **Profile Update**
  - Use existing profile update functionality
  - Verify updates work through backend API

### **Circle Creation Testing:**
- [ ] **Circle Creation with Image**
  - Navigate to create circle
  - Fill out all required fields
  - Upload a circle image
  - Submit form
  - Verify smart contract deployment succeeds
  - Verify metadata stored via backend
  - Check image appears correctly

- [ ] **Circle Creation without Image**
  - Complete circle creation without uploading image
  - Verify both contract deployment and metadata storage succeed

### **Authentication Flow Testing:**
- [ ] **Successful Authentication**
  - Verify wallet signature prompts appear
  - Test with different wallet types (MetaMask, WalletConnect, etc.)
  - Confirm signed requests reach backend successfully

- [ ] **Failed Authentication**
  - Test user rejecting signature request
  - Verify graceful error handling
  - Confirm user-friendly error messages

### **Error Scenario Testing:**
- [ ] **Backend Unavailable**
  - Stop backend server
  - Attempt profile/circle creation
  - Verify network error messages display correctly

- [ ] **Invalid Data**
  - Test with invalid form data
  - Verify backend validation errors display properly

- [ ] **Large File Upload**
  - Test with files larger than 5MB
  - Verify size limit enforcement

### **Integration Testing:**
- [ ] **CORS Configuration**
  - Verify frontend can communicate with backend
  - No CORS errors in browser console

- [ ] **Request/Response Formats**
  - Monitor network tab during operations
  - Verify API calls match expected format
  - Check response data structure

- [ ] **Existing Functionality**
  - Verify all existing read operations work unchanged
  - Test market browsing and display
  - Confirm smart contract interactions work
  - Check GraphQL queries still function

### **Performance Testing:**
- [ ] **File Upload Performance**
  - Test with various image sizes and formats
  - Verify reasonable upload times
  - Check for any timeout issues

- [ ] **API Response Times**
  - Monitor API call duration
  - Ensure no significant performance regression

## ðŸš¨ **Critical Validation Points**

### **Must Work:**
- âœ… Smart contract interactions remain client-side
- âœ… All existing Supabase read operations unchanged  
- âœ… GraphQL/subgraph queries unmodified
- âœ… User experience identical to before
- âœ… No visible UI changes

### **Must Be Secure:**
- âœ… All write operations require authentication
- âœ… Wallet signatures validated by backend
- âœ… Input sanitization handled server-side
- âœ… File uploads processed and optimized

### **Must Be Robust:**
- âœ… Graceful error handling for all scenarios
- âœ… Network failure recovery
- âœ… User-friendly error messages
- âœ… No console errors in production

## ðŸŽ¯ **Success Criteria**

**âœ… INTEGRATION COMPLETE** - Ready for testing when:
- [ ] Backend server starts successfully
- [ ] Frontend builds without errors
- [ ] All test cases pass
- [ ] No breaking changes to existing functionality
- [ ] User experience remains identical
- [ ] All write operations go through authenticated backend API

## ðŸ”§ **Next Steps**

1. **Start Backend Server**
   ```bash
   cd kuri-backend
   npm run dev
   ```

2. **Start Frontend Development Server**
   ```bash
   cd kuri_web  
   npm run dev
   ```

3. **Run Through Test Checklist**
   - Complete all testing requirements above
   - Document any issues found
   - Verify all functionality works as expected

4. **Deploy to Production**
   - Update VITE_BACKEND_URL in production environment
   - Deploy backend to Railway
   - Deploy frontend with updated environment variables